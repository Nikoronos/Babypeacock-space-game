<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>BPC ZigZag Prototype</title>
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
<style>
  html,body{
    margin:0;
    padding:0;
    height:100%;
    background:#000;
    overflow:hidden;
    font-family:system-ui,Segoe UI,Roboto,Arial;
  }
  canvas{
    display:block;
    width:100vw;
    height:100vh;
    background:radial-gradient(circle at center,#0f172a 0%,#020617 60%,#000 100%);
    touch-action:none;
    user-select:none;
  }
  #hud{
    position:fixed;
    left:0;top:0;right:0;
    height:42px;
    padding:8px 12px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    color:#e2e8f0;
    font-size:14px;
    background:linear-gradient(to bottom,rgba(0,0,0,0.7),transparent);
    pointer-events:none;
  }
  #brand{
    font-weight:900;
    background:linear-gradient(90deg,#22d3ee,#34d399);
    -webkit-background-clip:text;
    background-clip:text;
    color:transparent;
  }
  #scoreBox{font-weight:700;color:#00ffc8;text-shadow:0 0 6px rgba(0,255,200,0.5);}
  #info{
    position:fixed;
    left:50%;top:50%;
    transform:translate(-50%,-50%);
    color:#cbd5e1;
    font-size:13px;
    text-align:center;
    pointer-events:none;
  }
</style>
</head>
<body>

<div id="hud">
  <div id="brand">Babypeacock ðŸ¦š TEST</div>
  <div id="scoreBox">Score: <span id="sc">0</span></div>
</div>
<div id="info">
  ZigZag prototip<br>
  ParmaÄŸÄ±nÄ± basÄ±lÄ± tutup yana sÃ¼rÃ¼kle <br/>
  (player.png & enemy.png aynÄ± klasÃ¶rde olsun)
</div>
<canvas id="cv"></canvas>

<script>
// === KISA YARDIMCI FONKSÄ°YONLAR ===
const cv = document.getElementById("cv");
const ctx = cv.getContext("2d");
function resize(){
  cv.width  = window.innerWidth;
  cv.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

function rand(a,b){ return a + Math.random()*(b-a); }
function clamp(v,a,b){ return v<a?a : v>b?b : v; }
function rectHit(a,b){
  return !(a.x+a.w<b.x || a.x>b.x+b.w || a.y+a.h<b.y || a.y>b.y+b.h);
}

// === ASSETLER (SENÄ°N GEMÄ°LERÄ°N) ===
const playerImg = new Image();
playerImg.src = "player.png";   // buraya BPC gemini koy

const enemyImg = new Image();
enemyImg.src  = "enemy.png";    // buraya BPC dÃ¼ÅŸmanÄ±nÄ± koy

// === PLAYER ===
let player = {
  x: cv.width/2 - 33,
  y: cv.height - 100,
  w: 66,
  h: 66
};

let holding = false;
function getXFromEvent(e){
  const rect = cv.getBoundingClientRect();
  const cx = (e.clientX ?? (e.touches ? e.touches[0].clientX : 0)) - rect.left;
  return cx;
}

cv.addEventListener("pointerdown", e => {
  holding = true;
  player.x = clamp(getXFromEvent(e) - player.w/2, 0, cv.width-player.w);
});
cv.addEventListener("pointermove", e => {
  if(!holding) return;
  player.x = clamp(getXFromEvent(e) - player.w/2, 0, cv.width-player.w);
});
cv.addEventListener("pointerup",   () => holding=false);
cv.addEventListener("pointercancel",() => holding=false);

// === BULLETS & ENEMIES ===
let bullets = [];
let enemies = [];
let lastSpawn = 0;
let fireTimer = 0;
const FIRE_MS = 170; // BPC Space ile aynÄ± ateÅŸ hÄ±zÄ±
let score = 0;
const scEl = document.getElementById("sc");

// BPC hissi: dÃ¼ÅŸman hÄ±z aralÄ±klarÄ±
function spawnEnemy(){
  const size = rand(50,70);
  const vy   = rand(1.6, 2.8);      // dÃ¼ÅŸme hÄ±zÄ± (BPCâ€™ye yakÄ±n)
  const dir  = Math.random()<0.5?-1:1;
  const vx   = dir * rand(0.8, 1.6); // yatay zigzag hÄ±zÄ±

  enemies.push({
    x: rand(0, cv.width-size),
    y: -size,
    w: size,
    h: size,
    vx: vx,
    vy: vy
  });
}

function shoot(){
  bullets.push({
    x: player.x + player.w/2 - 2,
    y: player.y,
    w: 4,
    h: 12,
    vy: -10
  });
}

// === UPDATE ===
let lastTime = performance.now();
function update(dt){
  // ateÅŸ
  fireTimer += dt;
  if(holding && fireTimer > FIRE_MS){
    shoot();
    fireTimer = 0;
  }

  // dÃ¼ÅŸman spawn (yaklaÅŸÄ±k BPC spawn hissi)
  lastSpawn += dt;
  const spawnInterval = 650; // ms
  if(lastSpawn > spawnInterval){
    // ekrandaki dÃ¼ÅŸman sayÄ±sÄ±nÄ± sÄ±nÄ±rlayalÄ±m
    if(enemies.length < 10) spawnEnemy();
    lastSpawn = 0;
  }

  // mermiler
  bullets.forEach(b => { b.y += b.vy; });
  bullets = bullets.filter(b => b.y > -20);

  // dÃ¼ÅŸmanlar (zigzag + aÅŸaÄŸÄ±)
  enemies.forEach(e => {
    e.y += e.vy;
    e.x += e.vx;

    // kenara Ã§arpÄ±nca yÃ¶n deÄŸiÅŸtir ve clamp et
    if(e.x <= 0 || e.x + e.w >= cv.width){
      e.vx *= -1;
      e.x = clamp(e.x, 0, cv.width - e.w);
    }
  });
  enemies = enemies.filter(e => e.y < cv.height + 80);

  // Ã§arpÄ±ÅŸmalar
  const pBox = { x:player.x+10, y:player.y+10, w:player.w-20, h:player.h-20 };

  // dÃ¼ÅŸman-player Ã§arpÄ±ÅŸmasÄ± (sadece reset iÃ§in)
  enemies.forEach(e => {
    if(rectHit(pBox,e)){
      // Ã§arpÄ±lÄ±rsa sadece skor sÄ±fÄ±rla ve sahneyi temizle
      score = 0;
      scEl.textContent = score;
      bullets = [];
      enemies = [];
    }
  });

  // mermi-dÃ¼ÅŸman
  bullets.forEach(b => {
    enemies.forEach(e => {
      if(rectHit(b,e)){
        b.dead = true;
        e.dead = true;
        score++;
        scEl.textContent = score;
      }
    });
  });

  bullets  = bullets.filter(b => !b.dead);
  enemies  = enemies.filter(e => !e.dead);
}

// === DRAW ===
function draw(){
  ctx.clearRect(0,0,cv.width,cv.height);

  // oyuncu
  if(playerImg.complete){
    ctx.drawImage(playerImg, player.x, player.y, player.w, player.h);
  }else{
    ctx.fillStyle="#38bdf8";
    ctx.fillRect(player.x, player.y, player.w, player.h);
  }

  // mermiler
  ctx.fillStyle="#0ea5e9";
  bullets.forEach(b => ctx.fillRect(b.x,b.y,b.w,b.h));

  // dÃ¼ÅŸmanlar
  enemies.forEach(e => {
    if(enemyImg.complete){
      ctx.drawImage(enemyImg, e.x, e.y, e.w, e.h);
    }else{
      ctx.fillStyle="#ef4444";
      ctx.fillRect(e.x,e.y,e.w,e.h);
    }
  });
}

// === LOOP ===
function loop(now){
  const dt = Math.min(now - lastTime, 40); // ms
  lastTime = now;
  update(dt);
  draw();
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);
</script>
</body>
</html>
