<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover" />
<title>BPC - ZIGZAG TEST (NO IMAGES)</title>
<style>
  html,body{margin:0;height:100%;background:#000;font-family:monospace;overflow:hidden}
  
  #ui{
    position:fixed;top:10px;left:10px;
    color:#00ffc8;font-weight:bold;z-index:10;font-size:16px;
    text-shadow: 0 0 5px #000; pointer-events:none;
  }
  
  canvas{display:block;width:100%;height:100%;background:#020617;}
  
  .btn{
    position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
    padding:20px 40px; background:#0f172a; border:2px solid #00ffc8;
    color:#00ffc8; font-size:24px; font-weight:900; border-radius:12px;
    cursor:pointer; z-index:20; box-shadow: 0 0 20px rgba(0,255,200,0.3);
  }
  .btn:active { transform:translate(-50%,-50%) scale(0.95); background: #00ffc8; color:#000; }
</style>
</head>
<body>

<div id="ui">
  TEST MODU: AKTİF (RESİMSİZ)<br>
  <span style="color:#facc15">DURUM: 30 DÜŞMAN + ZIG-ZAG</span><br>
  Skor: <span id="sc">0</span>
</div>

<button id="startBtn" class="btn">BAŞLAT</button>
<canvas id="game"></canvas>

<script>
/* === BU VERSİYON HİÇBİR RESİM DOSYASI İSTEMEZ === */

const cv=document.getElementById("game");
const ctx=cv.getContext("2d");
const startBtn=document.getElementById("startBtn");
const scEl=document.getElementById("sc");

function resize(){ cv.width=window.innerWidth; cv.height=window.innerHeight; }
window.addEventListener('resize', resize); resize();

// OYUNCU AYARLARI
let player={x:cv.width/2-25, y:cv.height-100, w:50, h:50, color:"#38bdf8"};
let bullets=[], enemies=[];
let running=false, score=0, frames=0;

// KONTROLLER (MOBİL + PC)
let holding=false;
const getX = (e) => (e.clientX || (e.touches && e.touches[0].clientX) || 0);

cv.addEventListener("pointerdown",e=>{holding=true; movePlayer(getX(e));});
cv.addEventListener("pointermove",e=>{if(holding) movePlayer(getX(e));});
cv.addEventListener("pointerup",()=>holding=false);
cv.addEventListener("touchend",()=>holding=false);

function movePlayer(tx){
  player.x = Math.max(0, Math.min(cv.width-player.w, tx - player.w/2));
}

// OYUNU BAŞLAT
startBtn.onclick = () => {
  startBtn.style.display="none";
  running=true; 
  enemies=[]; bullets=[]; score=0; frames=0;
  player.y = cv.height - 100;
  loop();
};

function spawnEnemy(){
  // 30 Düşman Limiti (Hardcore Mod)
  if(enemies.length >= 30) return;
  
  const size = 40 + Math.random()*30; // Değişken boyut
  const xStart = Math.random() * (cv.width - size);
  
  // === ZIG-ZAG MANTIĞI BURADA ===
  // Rastgele sağa veya sola başla
  const dir = Math.random() < 0.5 ? -1 : 1;
  // Yatay hız (Zigzag şiddeti)
  const vx = dir * (2 + Math.random() * 2.5); 

  enemies.push({
    x: xStart, y: -size, w: size, h: size,
    vy: 2 + Math.random() * 2.5, // Aşağı inme hızı
    vx: vx, // <-- SAĞA SOLA GİTME HIZI
    color: Math.random()<0.5 ? "#ef4444" : "#22c55e" // Kırmızı veya Yeşil
  });
}

function update(){
  if(!running) return;
  frames++;

  // Otomatik Ateş (Saniyede ~6 mermi)
  if(frames % 10 === 0) {
    bullets.push({x:player.x+player.w/2-3, y:player.y, w:6, h:15, color:"#fbbf24"});
  }

  // Düşman Spawn (Çok sık)
  if(frames % 15 === 0) spawnEnemy();

  // Mermileri Güncelle
  bullets.forEach(b => b.y -= 12);
  bullets = bullets.filter(b => b.y > -20);

  // Düşmanları Güncelle
  enemies.forEach(e => {
    e.y += e.vy;     // Aşağı in
    e.x += e.vx;     // Sağa/Sola git (Zigzag)
    
    // EKRAN KENARINA ÇARPINCA SEKME (BOUNCE)
    if(e.x <= 0 || e.x + e.w >= cv.width){
       e.vx *= -1; // Yönü tersine çevir
    }
  });

  // Çarpışma Kontrolü
  for(let i=enemies.length-1; i>=0; i--){
    let e = enemies[i];
    let dead = false;

    // Mermi vurdu mu?
    for(let j=bullets.length-1; j>=0; j--){
      let b = bullets[j];
      if(b.x < e.x+e.w && b.x+b.w > e.x && b.y < e.y+e.h && b.y+b.h > e.y){
        bullets.splice(j,1);
        dead = true;
        score++; scEl.innerText = score;
        break;
      }
    }

    // Oyuncuya çarptı mı? (ÖLÜMSÜZ MOD - Sadece ekran yanıp söner)
    if(!dead && player.x < e.x+e.w && player.x+player.w > e.x && player.y < e.y+e.h && player.y+player.h > e.y){
      // Görsel uyarı
      ctx.fillStyle = "rgba(255,0,0,0.3)";
      ctx.fillRect(0,0,cv.width,cv.height);
    }

    if(dead) enemies.splice(i,1);
    else if(e.y > cv.height) enemies.splice(i,1);
  }

  draw();
  requestAnimationFrame(update);
}

function draw(){
  // Arkaplan (Hafif iz bırakır)
  ctx.fillStyle = "rgba(2, 6, 23, 0.6)";
  ctx.fillRect(0,0,cv.width,cv.height);

  // Oyuncu (Mavi Kutu)
  ctx.fillStyle = player.color;
  ctx.shadowBlur = 20; ctx.shadowColor = player.color;
  ctx.fillRect(player.x, player.y, player.w, player.h);
  ctx.shadowBlur = 0;

  // Mermiler (Sarı)
  ctx.fillStyle = "#fbbf24";
  bullets.forEach(b => ctx.fillRect(b.x, b.y, b.w, b.h));

  // Düşmanlar (Kutular + Yön Oku)
  enemies.forEach(e => {
    ctx.fillStyle = e.color;
    // Kutuyu çiz
    ctx.fillRect(e.x, e.y, e.w, e.h);
    
    // Üstüne Ok İşareti Çiz (Nereye gittiğini gör)
    ctx.fillStyle = "#fff";
    ctx.font = "bold 20px Arial";
    ctx.textAlign = "center";
    // Sağa gidiyorsa -> , Sola gidiyorsa <-
    ctx.fillText(e.vx > 0 ? "→" : "←", e.x + e.w/2, e.y + e.h/2 + 7);
  });
}
</script>
</body>
</html>
