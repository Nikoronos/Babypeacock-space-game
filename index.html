<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
<title>Babypeacock ‚Äî BPC Space Game</title>
<style>
  html,body{margin:0;height:100%;background:#000;font-family:system-ui,Segoe UI,Roboto,Arial}
  #brand{position:fixed;top:6px;left:12px;z-index:4;font-weight:900;
    background:linear-gradient(90deg,#22d3ee,#34d399);-webkit-background-clip:text;background-clip:text;color:transparent}
  #score{position:fixed;top:8px;left:0;right:0;text-align:center;color:#00ffc8;font-weight:700;z-index:4}
  #power{position:fixed;top:8px;right:10px;color:#a7f3d0;font-weight:700;z-index:4}
  #lives{position:fixed;bottom:10px;left:0;right:0;text-align:center;color:#f87171;font-weight:700;z-index:4}
  #gameOver,#startOverlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;flex-direction:column;
    background:rgba(0,0,0,.82);color:#fff;font-size:20px;font-weight:800;z-index:6}
  .btn{margin-top:12px;padding:12px 22px;border:1px solid #00ffc8;background:#0b1220;color:#00ffc8;border-radius:12px;font-weight:900}
  canvas{display:block;margin:44px auto 0 auto;background:#020617;
    touch-action:none;user-select:none;width:min(420px,96vw);height:auto;max-height:92vh}
</style>
</head>
<body>
  <div id="brand">Babypeacock ü¶ö</div>
  <div id="score">ü¶ö Score: <span id="sc">0</span></div>
  <div id="power">üíé x <span id="px">0</span></div>
  <div id="lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>

  <div id="startOverlay" style="display:flex">
    <div style="margin-bottom:8px">Ready?</div>
    <button id="startBtn" class="btn">START</button>
  </div>

  <div id="gameOver">
    <div>GAME OVER</div>
    <button id="restart" class="btn">Restart</button>
  </div>

  <canvas id="game" width="420" height="700"></canvas>

  <audio id="boom">
    <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_2b1b0dcd8c.mp3">
  </audio>

<script>
const cv=document.getElementById("game"),ctx=cv.getContext("2d");
ctx.imageSmoothingEnabled=false;

const scEl=document.getElementById("sc"),
pxEl=document.getElementById("px"),
livesEl=document.getElementById("lives"),
startOverlay=document.getElementById("startOverlay"),
startBtn=document.getElementById("startBtn"),
overEl=document.getElementById("gameOver"),
restartBtn=document.getElementById("restart"),
boom=document.getElementById("boom");

function clamp(v,a,b){return v<a?a:v>b?b:v}
function rand(a,b){return a+Math.random()*(b-a)}
function rectHit(a,b){return !(a.x+a.w<b.x||a.x>b.x+b.w||a.y+a.h<b.y||a.y>b.y+b.h)}

const PLAYER_SRC="img/player/bpc_mini.png";
const ENEMY_SRC={
 red:"bpc_enemy_red.png",
 green:"bpc_enemy_green.png",
 ufo_red:"bpc_enemy_ufo_red.png",
 ufo_gray:"bpc_enemy_ufo_gray.png"
};
const PEACOCK_SRC="yc3ku6.jpg";

let bullets=[], enemies=[], gems=[], enemyBullets=[], mascots=[], particles=[];
let score=0,powerShots=0,lives=3,started=false,gameOver=false;
let powerTime=0;
let fireTimer=0,FIRE_MS=170;
let elapsed=0,enT=0,gemT=0,mascotT=0;

const player={x:cv.width/2-33,y:cv.height-120,w:66,h:66};

const starsA=[],starsB=[];
for(let i=0;i<50;i++) starsA.push({x:rand(0,cv.width),y:rand(0,cv.height)});
for(let i=0;i<30;i++) starsB.push({x:rand(0,cv.width),y:rand(0,cv.height)});

function updateLives(){livesEl.innerHTML="‚ù§Ô∏è".repeat(lives)}

function startGame(){if(started)return; started=true;startOverlay.style.display="none";}
startBtn.onclick=startGame;cv.onclick=startGame;

let holding=false;
function getX(e){return(e.clientX??e.touches[0].clientX)-cv.getBoundingClientRect().left}
cv.onpointerdown=e=>{if(!started)return;holding=true;player.x=clamp(getX(e)-33,0,cv.width-player.w)}
cv.onpointermove=e=>{if(!holding)return;player.x=clamp(getX(e)-33,0,cv.width-player.w)}
cv.onpointerup=()=>holding=false

function shoot(){
 if(powerTime>0){
  bullets.push({x:player.x+32,y:player.y,w:4,h:12,vy:-10});
  bullets.push({x:player.x+32,y:player.y,w:4,h:12,vy:-10,ang:3});
  bullets.push({x:player.x+32,y:player.y,w:4,h:12,vy:-10,ang:-3});
 } else {
  bullets.push({x:player.x+32,y:player.y,w:4,h:12,vy:-10});
 }
}

function drawDiamondGem(ctx,x,y,w,h,t){
 ctx.save();ctx.translate(x+w/2,y+h/2);
 ctx.rotate(Math.sin(t*2)*0.2);
 const W=w*.9,H=h*.9;
 ctx.shadowColor="rgba(56,189,248,.8)";ctx.shadowBlur=14;
 let grad=ctx.createLinearGradient(-W/2,0,W/2,0);
 grad.addColorStop(0,"#baf2ff");
 grad.addColorStop(1,"#60e8ff");
 ctx.fillStyle=grad;
 ctx.beginPath();
 ctx.moveTo(0,-H*0.5);
 ctx.lineTo(W*0.45,0);
 ctx.lineTo(0,H*0.55);
 ctx.lineTo(-W*0.45,0);
 ctx.closePath();ctx.fill();
 ctx.shadowBlur=0;
 ctx.strokeStyle="#0e7490";ctx.lineWidth=2;ctx.stroke();
 ctx.restore();
}

function spawnEnemy(arr){
 if(enemies.length>12)return;
 const size=rand(48,70);
 const kind=arr[Math.floor(Math.random()*arr.length)];
 const img=enemyImg[kind]||null;
 enemies.push({x:rand(0,cv.width-size),y:-size,w:size,h:size,vy:rand(1.4,3),
  kind,img,canShoot:(kind==="red"||kind==="green"),shootT:0,shootInt:500});
}

function enemyShoot(e){
 if(!e.canShoot)return;
 enemyBullets.push({x:e.x+e.w/2-2,y:e.y+e.h,w:4,h:12,vy:6,color:e.kind=="red"?"#ef4444":"#00ff88"});
}

function spawnGem(){gems.push({x:rand(0,cv.width-20),y:-20,w:22,h:22,vy:1.5})}

function spawnMascot(){
 if(score>=200&&Math.random()<0.8)return;
 mascots.push({x:rand(0,cv.width-20),y:-20,w:22,h:22,vy:1.4})
}

function explosion(x,y){
 particles.push({x,y,life:400})
 try{boom.currentTime=0;boom.play()}catch{}
}

updateLives();

function update(dt){
 starsA.forEach(s=>{s.y+=0.3;if(s.y>cv.height){s.y=0;s.x=rand(0,cv.width)}})
 starsB.forEach(s=>{s.y+=0.7;if(s.y>cv.height){s.y=0;s.x=rand(0,cv.width)}})

 if(!started||gameOver)return;

 elapsed+=dt/1000;enT+=dt;gemT+=dt;mascotT+=dt;

 if(powerTime>0){powerTime-=dt;if(powerTime<=0){powerShots=0;powerTime=0}}

 fireTimer+=dt;if(holding&&fireTimer>FIRE_MS){shoot();fireTimer=0;}

 const allow = elapsed<10?["ufo_red","ufo_gray"]:
   elapsed<40?["ufo_red","ufo_gray","green"]:
   ["ufo_red","ufo_gray","green","red"];

 if(enT>600){spawnEnemy(allow);enT=0}
 if(gemT>6000){spawnGem();gemT=0}
 if(mascotT>12000){spawnMascot();mascotT=0}

 bullets.forEach(b=>{b.y+=b.vy;b.x+=(b.ang||0)*.5})
 bullets=bullets.filter(b=>b.y>-20)

 enemies.forEach(e=>{
  e.y+=e.vy*(score>=300?1.35:1);
  e.shootT+=dt;if(e.canShoot&&e.shootT>e.shootInt){e.shootT=0;enemyShoot(e);}
 })

 enemies=enemies.filter(e=>e.y<cv.height+40)

 enemyBullets.forEach(m=>m.y+=m.vy)
 enemyBullets=enemyBullets.filter(m=>m.y<cv.height+40)

 gems.forEach(g=>g.y+=g.vy);gems=gems.filter(g=>g.y<cv.height+40)
 mascots.forEach(m=>m.y+=m.vy);mascots=mascots.filter(m=>m.y<cv.height+40)

 enemies.forEach(e=>{
  if(rectHit(player,e)){explosion(player.x,player.y);lives--;updateLives();if(lives<=0)endGame();e.dead=1;}
 })

 enemyBullets.forEach(m=>{
  if(rectHit(player,m)){explosion(player.x,player.y);lives--;updateLives();if(lives<=0)endGame();m.dead=1;}
 })

 bullets.forEach(b=>{
  enemies.forEach(e=>{
   if(rectHit(b,e)){explosion(e.x,e.y);score++;scEl.textContent=score;b.dead=1;e.dead=1;}
  })
 })

 gems.forEach(g=>{
  if(rectHit(player,g)){
   powerTime=15*1000;
   powerShots=9999;
   pxEl.textContent=9999;
   g.dead=1;
  }
 })

 mascots.forEach(m=>{
  if(rectHit(player,m)){
   lives=Math.min(5,lives+1);updateLives();m.dead=1;
  }
 })

 enemies=enemies.filter(o=>!o.dead)
 bullets=bullets.filter(o=>!o.dead)
 enemyBullets=enemyBullets.filter(o=>!o.dead)
 gems=gems.filter(o=>!o.dead)
 mascots=mascots.filter(o=>!o.dead)
}

function endGame(){gameOver=true;overEl.style.display="flex"}

function draw(){
 ctx.clearRect(0,0,cv.width,cv.height)
 ctx.fillStyle="#fff"
 starsA.forEach(s=>ctx.fillRect(s.x,s.y,1,1))
 starsB.forEach(s=>ctx.fillRect(s.x,s.y,1,1))

 if(playerImg)ctx.drawImage(playerImg,player.x,player.y,player.w,player.h)

 ctx.fillStyle="#00ffc8"
 bullets.forEach(b=>ctx.fillRect(b.x,b.y,b.w,b.h))

 enemies.forEach(e=>{
  if(e.img)ctx.drawImage(e.img,e.x,e.y,e.w,e.h)
 })

 enemyBullets.forEach(m=>{
  ctx.fillStyle=m.color;ctx.fillRect(m.x,m.y,m.w,m.h)
 })

 gems.forEach(g=>drawDiamondGem(ctx,g.x,g.y,g.w,g.h,elapsed))

 if(peacockImg)mascots.forEach(m=>ctx.drawImage(peacockImg,m.x,m.y,m.w,m.h))

 particles.forEach(p=>{ctx.fillStyle="rgba(255,200,80,.9)";ctx.fillRect(p.x,p.y,6,6)})
}

function loop(t){const dt=Math.min(t-(window._lt||t),32);window._lt=t;update(dt);draw();requestAnimationFrame(loop)}
requestAnimationFrame(loop)

restartBtn.onclick=()=>{
 score=0;powerShots=0;lives=3;updateLives();
 bullets=[];enemies=[];enemyBullets=[];gems=[];particles=[];mascots=[];
 gameOver=false;started=false;overEl.style.display="none";startOverlay.style.display="flex";
}

let playerImg=null,enemyImg={red:null,green:null,ufo_red:null,ufo_gray:null},peacockImg=null;
function loadImage(s){return new Promise((res)=>{let i=new Image();i.onload=()=>res(i);i.src=s})}
(async function(){
 try{playerImg=await loadImage(PLAYER_SRC);}catch{}
 for(let k in ENEMY_SRC){
  try{enemyImg[k]=await loadImage(ENEMY_SRC[k])}catch{}
 }
 try{peacockImg=await loadImage(PEACOCK_SRC);}catch{}
})();
</script>
</body>
</html>
